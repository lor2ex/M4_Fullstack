## 1. Введение

### Что такое Alembic и зачем он нужен

Alembic — это инструмент для **миграций базы данных** в Python-проектах, использующих SQLAlchemy.

Основная задача Alembic — автоматически синхронизировать изменения в коде со структурой БД.

С помощью Alembic можно:

* автоматически отслеживать расхождения структуры БД в Python-коде и в самой БД,
* автоматически формировать скрипты для внесения изменений в БД,
* применять эти скрипты, и с их помощью:
  * создавать новые таблицы и колонки,
  * изменять существующие структуры,
  * откатывать изменения, если что-то пошло не так,
* то есть **синхронизировать** БД с актуальными моделями SQLAlchemy.

### Главная идея

Главная сила Alembic заключается в способности
* оценить разницу между моделями SQLAlchemy и текущей структурой БД, 
* а затем автоматически сгенерировать и применить команды для синхронизации.

### Почему это важно?

* **Ускоряет разработку**
  * не нужно вручную писать миграции для каждой правки.
* **Уменьшает риск ошибок**
  * автоматически учитываются все изменения в моделях и версии базы.
* **Упрощает командную работу** 
  * каждый разработчик может синхронизировать свою локальную базу с актуальными моделями без конфликтов.

---

### Сравнение Alembic и Django ORM

Alembic и Django ORM оба умеют автоматически генерировать миграции,  
но их подходы и возможности различаются.  

| Фича                              | Alembic                                                                                                          | Django ORM                                                                                                                |
|-----------------------------------|------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------|
| Автоматическая генерация миграций | Сравнивает модели SQLAlchemy с базой <br>и создаёт миграционные скрипты                                          | Аналогично                                                                                                                |
| Точность автогенерации            | Хорошо работает для стандартных изменений, <br>но сложные операции могут потребовать ручной проверки и доработки | Хорошо работает для стандартных изменений, <br>но хуже справляется со сложными                                            |
| Ручной контроль                   | Полный контроль: <br>можно дописывать автогенерируемые миграции <br>или писать их полностью вручную              | Ограниченный контроль: <br>сложные изменения сложнее реализовать, <br>часто приходится использовать кастомные SQL-команды |
| Откат миграций                    | Через `downgrade()`: <br>можно безопасно откатывать изменения                                                    | Через систему миграций Django; <br>откат возможен, но не всегда безопасен, <br>если миграция изменила данные              |
| Поддержка разных СУБД             | Работает с любыми СУБД, поддерживаемыми SQLAlchemy                                                               | Ограничена базами, поддерживаемыми Django ORM                                                                             |
| Работа в команде                  | Хранение версий базы упрощает синхронизацию <br>состояния базы между разработчиками                              | Синхронизация возможна, <br>но при сложных изменениях могут возникать конфликты                                           |


**Вывод:**

* **Alembic** лучше для сложных проектов, где важен контроль и гибкость.
* **Django ORM** подходит для проектов на Django с типовой модельной структурой и простыми изменениями.



