## 2. Основные возможности Alembic

### Генерация миграций

Alembic автоматически оценивает изменения в моделях SQLAlchemy и создаёт миграционные файлы.

Примеры команд:

* `alembic revision --autogenerate -m "add users table"` — создаёт скрипт миграции с учётом изменений в моделях.
* `alembic revision -m "custom migration"` — создаёт пустой скрипт для ручного редактирования.
* `alembic revision --empty -m "manual changes"` — создаёт пустую миграцию, чтобы отметить изменения, сделанные вручную в базе.

### Применение изменений

Команда `alembic upgrade` синхронизирует базу с текущим состоянием моделей.

Примеры команд:

* `alembic upgrade head` — применяет все миграции до последней версии.
* `alembic upgrade <revision_id>` — применяет миграции до указанной версии.

### Откат миграций

Команда `alembic downgrade` позволяет откатить изменения в базе.

Примеры команд:

* `alembic downgrade -1` — откатывает последнюю миграцию.
* `alembic downgrade <revision_id>` — откатывает базу к конкретной версии.

### Контроль версий базы

Alembic хранит текущую версию базы в таблице `alembic_version`, что существенно упрощает работу в команде:
* каждый разработчик может синхронизировать локальную базу с кодом без конфликтов.

  Примеры команд:

* `alembic current` — показывает текущую версию базы.
* `alembic history` — выводит список всех ревизий.

### Ручной контроль

Автогенерируемые миграции можно редактировать вручную, чтобы точно задать нужные изменения:

* переименование колонок или таблиц
* выполнение сложного SQL
* фиксация изменений, сделанных вручную в базе
  Команда:
  * редактирование файла миграции в папке `versions` после `alembic revision --autogenerate` 
  * или создания пустой миграции `alembic revision --empty`
    * когда изменения базы данных сделаны вручную 
    * или не могут быть автоматически сгенерированы Alembic

