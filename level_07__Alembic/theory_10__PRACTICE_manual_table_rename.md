## "–†—É—á–Ω–æ–µ" –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã 

### –ó–∞–¥–∞—á–∞

–¢–∞–±–ª–∏—Ü—É `"user"` –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å –≤ `account`.

---

### 1. –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é (–ø—É—Å—Ç—É—é) –º–∏–≥—Ä–∞—Ü–∏—é

```bash
alembic revision -m "manual rename user table to account"
```

---

### 2. –ò–∑–º–µ–Ω—è–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –º–∏–≥—Ä–∞—Ü–∏–∏

```python
from alembic import op


def upgrade() -> None:
    op.rename_table(
        'user',
        'account'
    )


def downgrade() -> None:
    op.rename_table(
        'account',
        'user'
    )
```

---

### 3. –ü—Ä–æ–≤–µ—Ä—è–µ–º SQL, –∫–æ—Ç–æ—Ä—ã–π —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∏–∑–º–µ–Ω—ë–Ω–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è

```bash
alembic upgrade head --sql
```

Alembic —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç:

```sql
ALTER TABLE "user" RENAME TO account;
```

* üîπ –û–ø–µ—Ä–∞—Ü–∏—è **–º–≥–Ω–æ–≤–µ–Ω–Ω–∞—è**  
* üîπ –î–∞–Ω–Ω—ã–µ **–Ω–µ –¥—É–±–ª–∏—Ä—É—é—Ç—Å—è** (–∏ –Ω–∏–∫—É–¥–∞ **–Ω–µ –ø–µ—Ä–µ–º–µ—â–∞—é—Ç—Å—è**)  
* üîπ –ò–Ω–¥–µ–∫—Å—ã –∏ constraints **—Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è** 

---

### 4. –ü—Ä–∏–º–µ–Ω—è–µ–º –º–∏–≥—Ä–∞—Ü–∏—é

```bash
alembic upgrade head
```

–õ–æ–≥ –æ–ø–µ—Ä–∞—Ü–∏–∏:

```
INFO  [alembic.runtime.migration] Context impl PostgresqlImpl.
INFO  [alembic.runtime.migration] Will assume transactional DDL.
INFO  [alembic.runtime.migration] Running upgrade 6930bb8b7e58 -> 637a667a152c, manual rename user table to account
```

---

### 5. –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç

```bash
./main.py
```

–∏–ª–∏:

```sql
–ù–∞–π–¥–µ–Ω–æ —Ç–∞–±–ª–∏—Ü: ['alembic_version', 'account']

–°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ç–∞–±–ª–∏—Ü—ã 'alembic_version':
{'version_num': '637a667a152c'}

–°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ç–∞–±–ª–∏—Ü—ã 'account':
{'id': 1, 'name': 'Alice', 'age': 25, 'email': 'alice@example.com', 'city': 'New York'}
{'id': 2, 'name': 'Bob', 'age': 30, 'email': 'bob@example.com', 'city': 'Los Angeles'}
{'id': 3, 'name': 'Charlie', 'age': 22, 'email': 'charlie@example.com', 'city': 'Chicago'}
{'id': 4, 'name': 'Diana', 'age': 28, 'email': 'diana@example.com', 'city': 'Houston'}
{'id': 5, 'name': 'Eve', 'age': 35, 'email': 'eve@example.com', 'city': 'Miami'}```
```

---

### 6. –ü—Ä–∏–≤–µ–¥–µ–Ω–∏–µ ORM-–º–æ–¥–µ–ª–∏ (–Ω–µ –∑–∞–±—ã–≤–∞–µ–º‚ùó)

–ü–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏ **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ**:

```python
class User(Base):
    __tablename__ = "account"
```

–ò–Ω–∞—á–µ SQLAlchemy –±—É–¥–µ—Ç –ø–∏—Å–∞—Ç—å –≤ —Å—Ç–∞—Ä—É—é —Ç–∞–±–ª–∏—Ü—É.


### 7. –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ ORM –∏ DB

–°–æ–∑–¥–∞—ë–º —Ç–µ—Å—Ç–æ–≤—É—é –º–∏–≥—Ä–∞—Ü–∏—é –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–æ–∑–º–æ–∂–Ω—ã—Ö —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–π:

```bash
alembic revision --autogenerate -m "test migration"
```

–î–æ–ª–∂–Ω–æ –±—ã—Ç—å –∏–º–µ–Ω–Ω–æ —Ç–∞–∫:

```python
def upgrade() -> None:
    """Upgrade schema."""
    # ### commands auto generated by Alembic - please adjust! ###
    pass
    # ### end Alembic commands ###


def downgrade() -> None:
    """Downgrade schema."""
    # ### commands auto generated by Alembic - please adjust! ###
    pass
    # ### end Alembic commands ###
```
---

### 8. –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ ORM –∏ DB

‚ùó –ù–µ –∑–∞–±—ã–≤–∞–µ–º —É–¥–∞–ª–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—É—é –º–∏–≥—Ä–∞—Ü–∏—é.

---

### ‚ö†Ô∏è –í–ê–ñ–ù–´–ï –ù–Æ–ê–ù–°–´ (–∏—Ö —á–∞—Å—Ç–æ —É–ø—É—Å–∫–∞—é—Ç)

#### 1. –í–Ω–µ—à–Ω–∏–µ –∫–ª—é—á–∏

PostgreSQL **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç** —Å—Å—ã–ª–∫–∏:

```sql
REFERENCES "user"(id)
```

—Å—Ç–∞–Ω–µ—Ç:

```sql
REFERENCES account(id)
```

‚úî –ù–∏—á–µ–≥–æ —Ä—É–∫–∞–º–∏ –ø—Ä–∞–≤–∏—Ç—å –Ω–µ –Ω—É–∂–Ω–æ!!!

---

#### 2. –ò–Ω–¥–µ–∫—Å—ã –∏ constraints

* `user_pkey`
* `user_email_key`

‚ùó –ê –≤–æ—Ç –∫–∞–∫ —Ä–∞–∑ —ç—Ç–∏ –æ–±—ä–µ–∫—Ç—ã **–ù–ï –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤—ã–≤–∞—é—Ç—Å—è**

–û–Ω–∏ –æ—Å—Ç–∞–Ω—É—Ç—Å—è, –Ω–∞–ø—Ä–∏–º–µ—Ä:

```text
user_pkey
```

–≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ, –Ω–æ –∏–Ω–æ–≥–¥–∞ —Ä–∞–∑–¥—Ä–∞–∂–∞–µ—Ç.

–ù–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤ ‚Äî –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—É—é –º–∏–≥—Ä–∞—Ü–∏—é (–ø–æ –∂–µ–ª–∞–Ω–∏—é).

