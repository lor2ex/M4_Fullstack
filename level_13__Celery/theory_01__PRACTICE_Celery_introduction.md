**Celery** ‚Äî —ç—Ç–æ **—Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–∞—è –æ—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á** (distributed task queue) –¥–ª—è Python. 


### –ß—Ç–æ —ç—Ç–æ –∑–Ω–∞—á–∏—Ç –∏ –≥–¥–µ —ç—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç?

Celery –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –¥–ª–∏—Ç–µ–ª—å–Ω—ã–µ / —Ç—è–∂—ë–ª—ã–µ / –Ω–µ—Å—Ä–æ—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ **–≤–Ω–µ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞** –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è  
(–∏–ª–∏ –≤–æ–æ–±—â–µ –ª—é–±–æ–≥–æ Python-—Å–∫—Ä–∏–ø—Ç–∞).

**–°–∞–º—ã–µ —á–∞—Å—Ç—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è**:

- –û—Ç–ø—Ä–∞–≤–∫–∞ email / push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∫–∞—Ä—Ç–∏–Ω–æ–∫ / –≤–∏–¥–µ–æ
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á—ë—Ç–æ–≤ (PDF, Excel –∏ —Ç.–¥.)
- –ü–∞—Ä—Å–∏–Ω–≥ —Å–∞–π—Ç–æ–≤ / –æ–±—Ä–∞–±–æ—Ç–∫–∞ –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤
- –ú–∞—Å—Å–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
- –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏ (–∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç, –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 3:00 –∏ —Ç.–¥.)
- –í—Å—ë, —á—Ç–æ –º–æ–∂–Ω–æ –æ—Ç–ª–æ–∂–∏—Ç—å –∏–ª–∏ –≤—ã–ø–æ–ª–Ω—è—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ

### –û—Å–Ω–æ–≤–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ Celery

–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç          | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                                   | –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏              |
|---------------------|-----------------------------------------------|--------------------------------------|
| **Message Broker**  | –æ—á–µ—Ä–µ–¥—å —Å–æ–æ–±—â–µ–Ω–∏–π / —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç –∑–∞–¥–∞—á          | **Redis**, RabbitMQ, SQS, ...       |
| **Result Backend**  | —Ö—Ä–∞–Ω–∏–ª–∏—â–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á       | **Redis**, –ë–î (PostgreSQL, MySQL), Memcached, RPC |
| **Celery app**      | —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –æ–±—ä–µ–∫—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏              | –≤–∞—à –∫–æ–¥ `from celery import Celery` |
| **Tasks**           | —Ñ—É–Ω–∫—Ü–∏–∏, –ø–æ–º–µ—á–µ–Ω–Ω—ã–µ `@app.task`              | –≤–∞—à –±–∏–∑–Ω–µ—Å-–∫–æ–¥                      |
| **Worker**          | –ø—Ä–æ—Ü–µ—Å—Å(—ã), –∫–æ—Ç–æ—Ä—ã–µ –≤—ã–ø–æ–ª–Ω—è—é—Ç –∑–∞–¥–∞—á–∏         | `celery -A proj worker`             |
| **Celery Beat**     | –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞—á              | `celery -A proj beat`               |
| **Flower** (–æ–ø—Ü.)   | –≤–µ–±-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∑–∞–¥–∞—á –∏ –≤–æ—Ä–∫–µ—Ä–æ–≤              | `celery -A proj flower`             |

### –ß–∞—â–µ –≤—Å–µ–≥–æ Celery –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É–µ—Ç c —ç—Ç–∏–º–∏ –ø–∞–∫–µ—Ç–∞–º–∏:

- **Redis** / **RabbitMQ** / **Amazon SQS** ‚Äî –±—Ä–æ–∫–µ—Ä
- **redis-py** / **kombu** ‚Äî –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è —Ä–∞–±–æ—Ç–∞ —Å –±—Ä–æ–∫–µ—Ä–æ–º
- **SQLAlchemy** / **Django ORM** / **asyncpg** ‚Äî –≤–Ω—É—Ç—Ä–∏ –∑–∞–¥–∞—á
- **Flower** ‚Äî –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- **sentry-sdk**, **rollbar**, **newrelic** ‚Äî –æ—Ç–ª–æ–≤ –æ—à–∏–±–æ–∫
- **fastapi** / **flask** / **django** ‚Äî –æ—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–¥–∞—á –∏–∑ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- **arq**, **dramatiq**, **RQ** ‚Äî –±–æ–ª–µ–µ –ª—ë–≥–∫–∏–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã

---

### –ü—Ä–æ—Å—Ç–µ–π—à–∏–π –ø—Ä–∏–º–µ—Ä: Celery + Redis —á–µ—Ä–µ–∑ Docker Compose

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞**

```
celery-redis-example/
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ celery_app.py
‚îú‚îÄ‚îÄ tasks.py
‚îî‚îÄ‚îÄ test_script.py
```

**–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø–∞–∫–µ—Ç—ã:**

```bash
pip install celery[redis] flower

pip freeze > requirements.txt
```

**–ó–∞–ø—É—Å–∫–∞–µ–º Redis –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ:**

`docker-compose.yml`

```yaml
services:
  redis:
    image: redis:7-alpine
    container_name: redis
    ports:
      - "6379:6379"
    volumes:
      - redis-data:/data
    healthcheck:
      test: ["CMD", "redis-cli", "ping"]
      interval: 5s
      timeout: 3s
      retries: 5

volumes:
  redis-data:
```

**–û—Å–Ω–æ–≤–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Celery**

`celery_app.py` 
```python
from celery import Celery

# –û–±—ã—á–Ω–æ –≤—ã–Ω–æ—Å—è—Ç –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π –º–æ–¥—É–ª—å
app = Celery(
    "simple_example",
    broker="redis://localhost:6379/0",   # –í production localhost –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ redis
    backend="redis://localhost:6379/0",  # –í production localhost –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ redis
    include=["tasks"],          # –º–æ–¥—É–ª—å —Å –∑–∞–¥–∞—á–∞–º–∏
)

# –ü–æ–ª–µ–∑–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
app.conf.update(
    task_track_started=True,
    task_time_limit=30 * 60,          # 30 –º–∏–Ω—É—Ç
    task_soft_time_limit=29 * 60,
    result_expires=3600,              # —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ö—Ä–∞–Ω–∏–º 1 —á–∞—Å
    worker_concurrency=2,
)
```

**–ú–æ–¥—É–ª—å —Å –æ—Å–Ω–æ–≤–Ω—ã–º–∏ –∑–∞–¥–∞—á–∞–º–∏:**

`tasks.py`

```python
from celery_app import app
import time

@app.task
def add(x, y):
    """–ü—Ä–æ—Å—Ç–∞—è –∑–∞–¥–∞—á–∞ –¥–ª—è —Ç–µ—Å—Ç–∞"""
    time.sleep(3)  # –∏–º–∏—Ç–∏—Ä—É–µ–º –¥–æ–ª–≥—É—é —Ä–∞–±–æ—Ç—É
    result = x + y
    print(f"–ó–∞–¥–∞—á–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞: {x} + {y} = {result}")
    return result

@app.task(bind=True, max_retries=3, default_retry_delay=5)
def flaky_task(self):
    """–ó–∞–¥–∞—á–∞, –∫–æ—Ç–æ—Ä–∞—è –∏–Ω–æ–≥–¥–∞ –ø–∞–¥–∞–µ—Ç"""
    x = time.time() % 2  # ~50% —à–∞–Ω—Å —É–ø–∞—Å—Ç—å
    print(f'time.time() % 2 = {x}')
    if x > 1: 
        raise self.retry(exc=ValueError("–û–π, —É–ø–∞–ª!"))
    return "–í—Å—ë –æ–∫!"

# –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–∞ @app.task():
# bind=True ‚Üí –¥–∞—ë—Ç –¥–æ—Å—Ç—É–ø –∫ self.retry() –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ø—ã—Ç–∫–∞—Ö
# max_retries=3 ‚Üí —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–ø—Ä–æ–±–æ–≤–∞—Ç—å (–≤—Å–µ–≥–æ –∑–∞–ø—É—Å–∫–æ–≤ = 1 + 3)
# default_retry_delay=5 ‚Üí —Å–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥ –∂–¥–∞—Ç—å –º–µ–∂–¥—É –ø–æ–ø—ã—Ç–∫–∞–º–∏

```

**–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç**  
(–∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ, –∫–æ–≥–¥–∞ Redis –∏ –≤–æ—Ä–∫–µ—Ä —É–∂–µ —Ä–∞–±–æ—Ç–∞—é—Ç)

`test_script.py`

```python
from celery_app import app
from tasks import add, flaky_task

if __name__ == "__main__":
    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–¥–∞—á—É
    res1 = add.delay(7, 11)
    print("–ó–∞–¥–∞—á–∞ add –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞, id =", res1.id)

    # –ú–æ–∂–Ω–æ —Å—Ä–∞–∑—É –∂–¥–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç (–Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ)
    print("–†–µ–∑—É–ª—å—Ç–∞—Ç:", res1.get(timeout=10))

    # –¶–µ–ø–æ—á–∫–∞ –∑–∞–¥–∞—á
    res2 = add.s(100, 200) | add.s(300)
    chained = res2.delay()
    print("–¶–µ–ø–æ—á–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞, id =", chained.id)

    # –ó–∞–¥–∞—á–∞ —Å —Ä–µ—Ç—Ä–∞—è–º–∏
    flaky_task.delay()
```

---
## –ù–∞—á–∏–Ω–∞–µ–º –Ω–∞—à–∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è

### 1. –ó–∞–ø—É—Å–∫ –≤–æ—Ä–∫–µ—Ä–∞ (–≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ)

```bash

# –ó–∞–ø—É—Å–∫ –æ–¥–Ω–æ–≥–æ –≤–æ—Ä–∫–µ—Ä–∞
celery -A celery_app worker --loglevel=INFO

# –ò–ª–∏ —Å beat (–µ—Å–ª–∏ –Ω—É–∂–Ω—ã –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏)
# celery -A celery_app worker --loglevel=INFO & celery -A celery_app beat --loglevel=INFO
```

–í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –¥–æ–ª–∂–Ω–æ –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å—Å—è —á—Ç–æ-—Ç–æ –≤—Ä–æ–¥–µ —ç—Ç–æ–≥–æ: 

```
 -------------- celery@su-Aspire-A517-58M v5.6.2 (recovery)
--- ***** ----- 
-- ******* ---- Linux-6.11.0-17-generic-x86_64-with-glibc2.39 2026-01-28 16:23:04
- *** --- * --- 
- ** ---------- [config]
- ** ---------- .> app:         simple_example:0x754a1cdc1400
- ** ---------- .> transport:   redis://localhost:6379/0
- ** ---------- .> results:     redis://localhost:6379/0
- *** --- * --- .> concurrency: 2 (prefork)
-- ******* ---- .> task events: OFF (enable -E to monitor tasks in this worker)
--- ***** ----- 
 -------------- [queues]
                .> celery           exchange=celery(direct) key=celery
                
                                                                                                                                                                                                                           
[tasks]
  . tasks.add
  . tasks.flaky_task

[2026-01-28 16:23:04,452: INFO/MainProcess] Connected to redis://localhost:6379/0
[2026-01-28 16:23:04,455: INFO/MainProcess] mingle: searching for neighbors
[2026-01-28 16:23:05,465: INFO/MainProcess] mingle: all alone
[2026-01-28 16:23:05,478: INFO/MainProcess] celery@su-Aspire-A517-58M ready.

```

#### 1.1. –ß—Ç–æ —ç—Ç–æ –∑–Ω–∞—á–∏—Ç?

```
-------------- celery@su-Aspire-A517-58M v5.6.2 (recovery)
--- ***** ----- 
-- ******* ---- Linux-6.11.0-17-generic-x86_64-with-glibc2.39 2026-01-28 16:23:04
...
```
Celery –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤–µ—Ä—Å–∏—é (5.6.2), –∏–º—è —Ö–æ—Å—Ç–∞ (su-Aspire-A517-58M), –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É –∏ –≤—Ä–µ–º—è –∑–∞–ø—É—Å–∫–∞.

```
[config]
.> app:         simple_example:0x754a1cdc1400
.> transport:   redis://localhost:6379/0
.> results:     redis://localhost:6379/0
.> concurrency: 2 (prefork)
.> task events: OFF (enable -E to monitor tasks in this worker)
```
**–í–∞–∂–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è:**

- `transport` 
  - –±—Ä–æ–∫–µ—Ä = Redis (localhost:6379, –±–∞–∑–∞ 0)
- `results` 
  - –±—ç–∫–µ–Ω–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ = —Ç–æ—Ç –∂–µ Redis
- `concurrency: 2 (prefork)`
  - –±—É–¥–µ—Ç –∑–∞–ø—É—â–µ–Ω–æ **2 –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–∞-–≤–æ—Ä–∫–µ—Ä–∞** 
    - 1 –ø–ª–æ—Ö–æ: —Ç–æ–≥–¥–∞ –≤—Å–µ –∑–∞–¥–∞—á–∏ –±—É–¥—É—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ (–Ω–∏–∫–∞–∫–æ–≥–æ –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–∞)
    - \> 2 –º–æ–∂–Ω–æ, –¥–æ–ø—É—Å—Ç–∏–º–æ, –µ—Å–ª–∏ CPU > 2, –∏–Ω–∞—á–µ - –Ω–µ–ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ —É–≤–µ–ª–∏—á–∏—Ç –Ω–∞–≥—Ä—É–∑–∫—É. 
- `task events: OFF` 
  - —Å–æ–±—ã—Ç–∏—è –æ –∑–∞–¥–∞—á–∞—Ö (–Ω–∞—á–∞–ª–æ/—É—Å–ø–µ—Ö/–æ—à–∏–±–∫–∞) **–Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è** –≤ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (Flower, Sentry –∏ —Ç.–ø.). 
  - –ß—Ç–æ–±—ã –≤–∫–ª—é—á–∏—Ç—å, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–æ–±–∞–≤–∏—Ç—å —Ñ–ª–∞–≥ `-E` –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ

```
[queues]
.> celery           exchange=celery(direct) key=celery
```
–°–µ–π—á–∞—Å –≤–æ—Ä–∫–µ—Ä —Å–ª—É—à–∞–µ—Ç **—Ç–æ–ª—å–∫–æ –æ—á–µ—Ä–µ–¥—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é** ‚Äî `celery`.  
–î–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –¥—Ä—É–≥–∏—Ö –æ—á–µ—Ä–µ–¥–µ–π ‚Äî –Ω—É–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å `-Q queue1,queue2` –∏–ª–∏ –≤ –∫–æ–Ω—Ñ–∏–≥–µ.

```
[tasks]
  . tasks.add
  . tasks.flaky_task
```
Celery –Ω–∞—à—ë–ª **–¥–≤–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏** (–∏–∑ –º–æ–¥—É–ª—è `tasks.py`).

```
[2026-01-28 16:23:04,452: INFO/MainProcess] Connected to redis://localhost:6379/0
```
–£—Å–ø–µ—à–Ω–æ –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è –∫ Redis (–±—Ä–æ–∫–µ—Ä—É).

```
[2026-01-28 16:23:04,455: INFO/MainProcess] mingle: searching for neighbors
[2026-01-28 16:23:05,465: INFO/MainProcess] mingle: all alone
```
**Mingle** ‚Äî —ç—Ç–æ –º–µ—Ö–∞–Ω–∏–∑–º, –∫–æ–≥–¥–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–æ—Ä–∫–µ—Ä–æ–≤ –æ–±–º–µ–Ω–∏–≤–∞—é—Ç—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ   
(–≤—Ä–µ–º—è, –æ—Ç–æ–∑–≤–∞–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏, revoked tasks –∏ —Ç.–ø.).    
–ó–¥–µ—Å—å –æ–Ω –∏—Å–∫–∞–ª –¥—Ä—É–≥–∏—Ö –≤–æ—Ä–∫–µ—Ä–æ–≤ ‚Üí –Ω–∏–∫–æ–≥–æ –Ω–µ –Ω–∞—à—ë–ª ‚Üí ¬´all alone¬ª (–æ–¥–∏–Ω –≤ –ø–æ–ª–µ –≤–æ–∏–Ω).    
–≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è –Ω–∞—à–µ–π —Å–∏—Ç—É–∞—Ü–∏–∏: —Å–µ–π—á–∞—Å –∑–∞–ø—É—â–µ–Ω —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –≤–æ—Ä–∫–µ—Ä.  

```
[2026-01-28 16:23:05,478: INFO/MainProcess] celery@su-Aspire-A517-58M ready.
```
–í–æ—Ä–∫–µ—Ä –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤ –ø—Ä–∏–Ω–∏–º–∞—Ç—å –∑–∞–¥–∞—á–∏!  
–¢–µ–ø–µ—Ä—å –æ–Ω –±—É–¥–µ—Ç –∂–¥–∞—Ç—å, –ø–æ–∫–∞ –∫—Ç–æ-—Ç–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç –∑–∞–¥–∞—á—É –≤ –æ—á–µ—Ä–µ–¥—å `celery`.

#### 1.2. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º,

- –í–æ—Ä–∫–µ—Ä –∑–∞–ø—É—Å—Ç–∏–ª—Å—è **—É—Å–ø–µ—à–Ω–æ**
- –ü–æ–¥–∫–ª—é—á–∏–ª—Å—è –∫ Redis
- –ì–æ—Ç–æ–≤ –ø—Ä–∏–Ω–∏–º–∞—Ç—å –∑–∞–¥–∞—á–∏ –∏–∑ –æ—á–µ—Ä–µ–¥–∏ `celery`
- –†–∞–±–æ—Ç–∞–µ—Ç —Å 2 –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏ (concurrency=2)
- –û–¥–∏–Ω –≤ —Å–∏—Å—Ç–µ–º–µ (no other workers found ‚Üí all alone ‚Äî —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ)


### 2. –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ —Å–æ —Å–∫—Ä–∏–ø—Ç–æ–º `test_script.py` 

#### 2.1. –ß—Ç–æ –¥–µ–ª–∞–µ—Ç —ç—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç?

–ü—Ä–µ–∂–¥–µ —á–µ–º –∑–∞–ø—É—Å–∫–∞—Ç—å, –¥–∞–≤–∞–π—Ç–µ —Å–Ω–∞—á–∞–ª–∞ —Ä–∞–∑–±–µ—Ä—ë–º—Å—è —Å —Ç–µ–º, —á—Ç–æ –±—É–¥–µ—Ç –¥–µ–ª–∞—Ç—å —ç—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç.

1. –û—Ç–ø—Ä–∞–≤–∫–∞ –ø—Ä–æ—Å—Ç–æ–π –∑–∞–¥–∞—á–∏
   ```python
   res1 = add.delay(7, 11)
   print("–ó–∞–¥–∞—á–∞ add –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞, id =", res1.id)
   ```
   - `add.delay(7, 11)` ‚Äî **–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ** –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–¥–∞—á—É `add(x, y)` –≤ –æ—á–µ—Ä–µ–¥—å Celery  
   - –í–º–µ—Å—Ç–æ –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è `add(7, 11)` —Ñ—É–Ω–∫—Ü–∏—è –∫–ª–∞–¥—ë—Ç—Å—è –≤ –æ—á–µ—Ä–µ–¥—å Redis  
   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –æ–±—ä–µ–∫—Ç `AsyncResult` (res1), —É –∫–æ—Ç–æ—Ä–æ–≥–æ –µ—Å—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–π `id` –∑–∞–¥–∞—á–∏  
   - –ü–µ—á–∞—Ç–∞–µ—Ç—Å—è id ‚Äî —ç—Ç–æ –ø–æ–ª–µ–∑–Ω–æ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏, –ø–æ–∏—Å–∫–∞ –∑–∞–¥–∞—á–∏ –≤ Flower –∏ —Ç.–¥.

2. –û–∂–∏–¥–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ (—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π get)
   ```python
   print("–†–µ–∑—É–ª—å—Ç–∞—Ç:", res1.get(timeout=10))
   ```
   - `res1.get(timeout=10)` ‚Äî **–±–ª–æ–∫–∏—Ä—É–µ—Ç** –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–∞ –∏ –∂–¥—ë—Ç, –ø–æ–∫–∞ –∑–∞–¥–∞—á–∞ –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è  
   - –ú–∞–∫—Å–∏–º—É–º –∂–¥—ë—Ç 10 —Å–µ–∫—É–Ω–¥, –µ—Å–ª–∏ –∑–∞ —ç—Ç–æ –≤—Ä–µ–º—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–µ –ø–æ—è–≤–∏—Ç—Å—è ‚Äî –≤—ã–±—Ä–æ—Å–∏—Ç `TimeoutError`  
   - **–í–∞–∂–Ω–æ**: –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ (FastAPI, Django –∏ —Ç.–¥.) —Ç–∞–∫ **–Ω–∏–∫–æ–≥–¥–∞** –Ω–µ –¥–µ–ª–∞—é—Ç, 
     - –ø–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø–æ—Ç–æ–∫/–≤–æ—Ä–∫–µ—Ä.
     - –ò—Å–ø–æ–ª—å–∑—É—é—Ç `.get()` —Ç–æ–ª—å–∫–æ –≤ —Å–∫—Ä–∏–ø—Ç–∞—Ö, —Ç–µ—Å—Ç–∞—Ö, CLI-—É—Ç–∏–ª–∏—Ç–∞—Ö.

3. –°–æ–∑–¥–∞–Ω–∏–µ –∏ –∑–∞–ø—É—Å–∫ —Ü–µ–ø–æ—á–∫–∏ –∑–∞–¥–∞—á (chain)
   ```python
   res2 = add.s(100, 200) | add.s(300)
   chained = res2.delay()
   print("–¶–µ–ø–æ—á–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞, id =", chained.id)
   ```
   –ó–¥–µ—Å—å –ø–æ—è–≤–ª—è–µ—Ç—Å—è –Ω–æ–≤–æ–µ –ø–æ–Ω—è—Ç–∏–µ ‚Äî **—Å–∏–≥–Ω–∞—Ç—É—Ä–∞** (signature):

   - `add.s(100, 200)` ‚Äî —ç—Ç–æ **—Å–∏–≥–Ω–∞—Ç—É—Ä–∞** –∑–∞–¥–∞—á–∏  
     `.s()` ‚Äî –º–µ—Ç–æ–¥, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–∑–¥–∞—ë—Ç –æ–±—ä–µ–∫—Ç `Signature`, –∞ –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∑–∞–¥–∞—á—É —Å—Ä–∞–∑—É

   - `|` ‚Äî –æ–ø–µ—Ä–∞—Ç–æ—Ä —Ü–µ–ø–æ—á–∫–∏ (chain)  
     –û–Ω –≥–æ–≤–æ—Ä–∏—Ç: ¬´–≤—ã–ø–æ–ª–Ω–∏ –ø–µ—Ä–≤—É—é –∑–∞–¥–∞—á—É, –≤–æ–∑—å–º–∏ –µ—ë —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏ –ø–µ—Ä–µ–¥–∞–π –∫–∞–∫ **–ø–µ—Ä–≤—ã–π** –∞—Ä–≥—É–º–µ–Ω—Ç —Å–ª–µ–¥—É—é—â–µ–π –∑–∞–¥–∞—á–µ¬ª

   –ò—Ç–æ–≥–æ–≤–∞—è —Ü–µ–ø–æ—á–∫–∞ –æ–∑–Ω–∞—á–∞–µ—Ç:

   ```
   result1 = add(100, 200)          # ‚Üí 300
   result2 = add(result1, 300)      # ‚Üí 600
   ```

   –¢–æ –µ—Å—Ç—å —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è:

   ```python
   add( add(100, 200), 300 )
   ```

   - `res2.delay()` ‚Äî –∑–∞–ø—É—Å–∫–∞–µ—Ç **–≤—Å—é —Ü–µ–ø–æ—á–∫—É** –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ  
   - `chained` ‚Äî —ç—Ç–æ —Ç–æ–∂–µ `AsyncResult`, –Ω–æ –≥—Ä—É–ø–ø–æ–≤–æ–π (–¥–ª—è —Ü–µ–ø–æ—á–∫–∏)  
   - –£ –Ω–µ–≥–æ –µ—Å—Ç—å —Å–≤–æ–π `id` ‚Äî —ç—Ç–æ id **–ø–æ—Å–ª–µ–¥–Ω–µ–π** –∑–∞–¥–∞—á–∏ –≤ —Ü–µ–ø–æ—á–∫–µ

4. –ó–∞–ø—É—Å–∫ –∑–∞–¥–∞—á–∏ —Å —Ä–µ—Ç—Ä–∞—è–º–∏ (–ø–æ–≤—Ç–æ—Ä–∞–º–∏ –ø—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –æ—à–∏–±–∫–∏)
   ```python
   flaky_task.delay()
   ```
   - –ü—Ä–æ—Å—Ç–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–¥–∞—á—É `flaky_task()` –≤ –æ—á–µ—Ä–µ–¥—å  
   - –ù–∏–∫–∞–∫–∏—Ö –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –Ω–µ –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è  
   - –ï—Å–ª–∏ –≤ `flaky_task` –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã `max_retries` –∏ `autoretry_for` –∏–ª–∏ –µ—Å—Ç—å —è–≤–Ω—ã–π `self.retry()`, 
     - —Ç–æ –ø—Ä–∏ –æ—à–∏–±–∫–µ –∑–∞–¥–∞—á–∞ –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è


#### 2.2. –ó–∞–ø—É—Å–∫–∞–µ–º —Å–∫—Ä–∏–ø—Ç `test_script.py` 

–í –Ω–æ–≤–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –∑–∞–ø—É—Å–∫–∞–µ–º:
```bash
python test_script.py
```

–∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª —Å Celery:

```
[2026-01-30 20:30:26,956: INFO/MainProcess] Task tasks.add[fcd6740f-fb8b-4821-900e-fdfec3d317cd] received
[2026-01-30 20:30:29,960: WARNING/ForkPoolWorker-2] –ó–∞–¥–∞—á–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞: 7 + 11 = 18
[2026-01-30 20:30:29,963: INFO/ForkPoolWorker-2] Task tasks.add[fcd6740f-fb8b-4821-900e-fdfec3d317cd] succeeded in 3.00465920500028s: 18
[2026-01-30 20:30:29,968: INFO/MainProcess] Task tasks.add[53ac4009-0e61-4170-a231-7a581352e91f] received
[2026-01-30 20:30:29,972: INFO/MainProcess] Task tasks.flaky_task[c2768d05-344b-4fdf-b166-814db74a11a9] received
[2026-01-30 20:30:29,974: WARNING/ForkPoolWorker-1] time.time() % 2 = 1.9741148948669434
[2026-01-30 20:30:30,008: INFO/MainProcess] Task tasks.flaky_task[c2768d05-344b-4fdf-b166-814db74a11a9] received
[2026-01-30 20:30:30,020: INFO/ForkPoolWorker-1] Task tasks.flaky_task[c2768d05-344b-4fdf-b166-814db74a11a9] retry: Retry in 5s: ValueError('–û–π, —É–ø–∞–ª!')
[2026-01-30 20:30:32,974: WARNING/ForkPoolWorker-2] –ó–∞–¥–∞—á–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞: 100 + 200 = 300
[2026-01-30 20:30:32,978: INFO/ForkPoolWorker-2] Task tasks.add[53ac4009-0e61-4170-a231-7a581352e91f] succeeded in 3.0046977670008346s: 300
[2026-01-30 20:30:32,979: INFO/MainProcess] Task tasks.add[0bb18bf4-005d-498b-8982-da7ae61333b3] received
[2026-01-30 20:30:34,982: INFO/ForkPoolWorker-1] Task tasks.flaky_task[c2768d05-344b-4fdf-b166-814db74a11a9] succeeded in 0.0032421720006823307s: '–í—Å—ë –æ–∫!'
[2026-01-30 20:30:35,982: WARNING/ForkPoolWorker-2] –ó–∞–¥–∞—á–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞: 300 + 300 = 600
[2026-01-30 20:30:35,984: INFO/ForkPoolWorker-2] Task tasks.add[0bb18bf4-005d-498b-8982-da7ae61333b3] succeeded in 3.0033645409985184s: 600
```


### –ß—Ç–æ –º—ã –≤–∏–¥–∏–º –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ?

–û—Ç–ª–∏—á–Ω—ã–π –ø—Ä–∏–º–µ—Ä, —Å–ø–∞—Å–∏–±–æ ‚Äî —Ç–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ —Ä–∞–∑–æ–±—Ä–∞—Ç—å **–Ω–æ–≤—ã–π –ª–æ–≥ —Ä–æ–≤–Ω–æ –≤ —Ç–æ–º –∂–µ —Å—Ç–∏–ª–µ**, –∞–∫–∫—É—Ä–∞—Ç–Ω–æ –∏ –ø–æ —à–∞–≥–∞–º.
–ù–∏–∂–µ ‚Äî **–ø–æ—Å—Ç—Ä–æ—á–Ω—ã–π —Ä–∞–∑–±–æ—Ä –Ω–æ–≤–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞**, —Å –∞–∫—Ü–µ–Ω—Ç–æ–º –Ω–∞ retry.

---

## –†–∞–∑–±–æ—Ä –ø–æ —à–∞–≥–∞–º (–Ω–æ–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç)

```
[2026-01-30 20:30:26,956: INFO/MainProcess] Task tasks.add[fcd6740f-fb8b-4821-900e-fdfec3d317cd] received
```

* –ü–µ—Ä–≤–∞—è –∑–∞–¥–∞—á–∞ `add(7, 11)` –ø–æ–º–µ—â–µ–Ω–∞ –≤ –æ—á–µ—Ä–µ–¥—å –∏ –≤–∑—è—Ç–∞ –≤–æ—Ä–∫–µ—Ä–æ–º.

```
[2026-01-30 20:30:29,960: WARNING/ForkPoolWorker-2] –ó–∞–¥–∞—á–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞: 7 + 11 = 18
[2026-01-30 20:30:29,963: INFO/ForkPoolWorker-2] Task tasks.add[fcd6740f-fb8b-4821-900e-fdfec3d317cd] succeeded in 3.00465920500028s: 18
```

* –ó–∞–¥–∞—á–∞ –≤—ã–ø–æ–ª–Ω—è–ª–∞—Å—å ~3 —Å–µ–∫—É–Ω–¥—ã (`time.sleep(3)`)
* –†–µ–∑—É–ª—å—Ç–∞—Ç: `18`
* –°—Ç–∞—Ç—É—Å: **—É—Å–ø–µ—à–Ω–æ (succeeded)**
* `WARNING` ‚Äî —ç—Ç–æ `print()` –≤–Ω—É—Ç—Ä–∏ –∑–∞–¥–∞—á–∏, –Ω–µ –æ—à–∏–±–∫–∞.

---

```
[2026-01-30 20:30:29,968: INFO/MainProcess] Task tasks.add[53ac4009-0e61-4170-a231-7a581352e91f] received
```

* –í –æ—á–µ—Ä–µ–¥—å –ø–æ—Å—Ç—É–ø–∏–ª–∞ —Å–ª–µ–¥—É—é—â–∞—è –∑–∞–¥–∞—á–∞ —Ü–µ–ø–æ—á–∫–∏: `add(100, 200)`.

```
[2026-01-30 20:30:29,972: INFO/MainProcess] Task tasks.flaky_task[c2768d05-344b-4fdf-b166-814db74a11a9] received
```

* –ü–æ—á—Ç–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ —Å—Ç–∞—Ä—Ç—É–µ—Ç `flaky_task()`
* –≠—Ç–æ **–ø–µ—Ä–≤–∞—è –ø–æ–ø—ã—Ç–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è** (`retries = 0`).

---

```
[2026-01-30 20:30:29,974: WARNING/ForkPoolWorker-1] time.time() % 2 = 1.9741148948669434
```

* –í–Ω—É—Ç—Ä–∏ `flaky_task` –≤—ã—á–∏—Å–ª–µ–Ω–æ –∑–Ω–∞—á–µ–Ω–∏–µ `time.time() % 2`
* –ó–Ω–∞—á–µ–Ω–∏–µ **–±–æ–ª—å—à–µ 1**, –∑–Ω–∞—á–∏—Ç —É—Å–ª–æ–≤–∏–µ –ø–∞–¥–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è.

---

```
[2026-01-30 20:30:30,008: INFO/MainProcess] Task tasks.flaky_task[c2768d05-344b-4fdf-b166-814db74a11a9] received
```

* Celery **–ø–ª–∞–Ω–∏—Ä—É–µ—Ç –ø–æ–≤—Ç–æ—Ä –∑–∞–¥–∞—á–∏**
* –¢–∞ –∂–µ –∑–∞–¥–∞—á–∞ (`task id` —Ç–æ—Ç –∂–µ) —Å–Ω–æ–≤–∞ –ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∞ –≤ –æ—á–µ—Ä–µ–¥—å
* –≠—Ç–æ –µ—â—ë **–Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ**, –∞ –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ retry.

---

```
[2026-01-30 20:30:30,020: INFO/ForkPoolWorker-1] Task tasks.flaky_task[c2768d05-344b-4fdf-b166-814db74a11a9] retry: Retry in 5s: ValueError('–û–π, —É–ø–∞–ª!')
```

* –ö–ª—é—á–µ–≤–∞—è —Å—Ç—Ä–æ–∫–∞ üî•
* `self.retry()` —Å—Ä–∞–±–æ—Ç–∞–ª –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
* Celery:

  * –ø–æ–π–º–∞–ª `ValueError`
  * –ø–µ—Ä–µ–≤—ë–ª –∑–∞–¥–∞—á—É –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ **RETRY**
  * –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–ª –ø–æ–≤—Ç–æ—Ä —á–µ—Ä–µ–∑ **5 —Å–µ–∫—É–Ω–¥**
* –≠—Ç–æ **–Ω–µ FAILED**, –∞ –æ–∂–∏–¥–∞–µ–º—ã–π retry.

---

```
[2026-01-30 20:30:32,974: WARNING/ForkPoolWorker-2] –ó–∞–¥–∞—á–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞: 100 + 200 = 300
[2026-01-30 20:30:32,978: INFO/ForkPoolWorker-2] Task tasks.add[53ac4009-0e61-4170-a231-7a581352e91f] succeeded in 3.0046977670008346s: 300
```

* –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è —Ü–µ–ø–æ—á–∫–∞:

  * `add(100, 200)` –≤—ã–ø–æ–ª–Ω–µ–Ω–∞
  * —Ä–µ–∑—É–ª—å—Ç–∞—Ç `300`
* –¶–µ–ø–æ—á–∫–∞ **–Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è** retry-–∑–∞–¥–∞—á–µ–π.

---

```
[2026-01-30 20:30:32,979: INFO/MainProcess] Task tasks.add[0bb18bf4-005d-498b-8982-da7ae61333b3] received
```

* –í –æ—á–µ—Ä–µ–¥—å –¥–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ–∏–Ω–∞–ª—å–Ω–∞—è —á–∞—Å—Ç—å —Ü–µ–ø–æ—á–∫–∏: `add(300, 300)`.

---

```
[2026-01-30 20:30:34,980: WARNING/ForkPoolWorker-1] time.time() % 2 = 0.9800543785095215
```

* `flaky_task` –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è **–≤—Ç–æ—Ä–æ–π —Ä–∞–∑** (retry)
* –ó–Ω–∞—á–µ–Ω–∏–µ –º–µ–Ω—å—à–µ 1 ‚Üí –æ—à–∏–±–∫–∞ **–Ω–µ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç**.

---

```
[2026-01-30 20:30:34,982: INFO/ForkPoolWorker-1] Task tasks.flaky_task[c2768d05-344b-4fdf-b166-814db74a11a9] succeeded in 0.0032421720006823307s: '–í—Å—ë –æ–∫!'
```

* Retry-–ø–æ–ø—ã—Ç–∫–∞ –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ
* `flaky_task` –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º **succeeded**
* –í–æ–∑–≤—Ä–∞—â–µ–Ω–æ –∑–Ω–∞—á–µ–Ω–∏–µ `"–í—Å—ë –æ–∫!"`

---

```
[2026-01-30 20:30:35,982: WARNING/ForkPoolWorker-2] –ó–∞–¥–∞—á–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞: 300 + 300 = 600
[2026-01-30 20:30:35,984: INFO/ForkPoolWorker-2] Task tasks.add[0bb18bf4-005d-498b-8982-da7ae61333b3] succeeded in 3.0033645409985184s: 600
```

* –ü–æ—Å–ª–µ–¥–Ω—è—è –∑–∞–¥–∞—á–∞ —Ü–µ–ø–æ—á–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞
* –†–µ–∑—É–ª—å—Ç–∞—Ç: `600`
* **–í—Å—è —Ü–µ–ø–æ—á–∫–∞ —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∞**, –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ retry –≤ `flaky_task`.

---

### –ó–∞–ø—É—Å–∫–∞–µ–º Flower –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∑–∞–¥–∞—á –≤ –¥–∞—à–±–æ—Ä–¥–µ:

1. –ó–∞–ø—É—Å–∫–∞–µ–º
```bash
celery -A celery_app flower --port=5555
```

2. –ó–∞—Ö–æ–¥–∏–º –≤ –±—Ä–∞—É–∑–µ—Ä–µ: http://localhost:5555

–ö–∞–∫ –≤–∏–¥–∏–º, –≤—Å—ë –ø—É—Å—Ç–æ: —Å–æ–±—ã—Ç–∏—è –≤–∏–¥–Ω—ã —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –≤–æ—Ä–∫–µ—Ä –∑–∞–ø—É—à–µ–Ω —Å —Ñ–ª–∞–≥–æ–º `-E`

3. –ò—Å–ø—Ä–∞–≤–ª—è–µ–º —Å–∏—Ç—É–∞—Ü–∏—é:

   * –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ–∫—É—â–∏–π –≤–æ—Ä–∫–µ—Ä (Ctrl+C)

   * –ó–∞–ø—É—Å–∫–∞–µ–º –µ–≥–æ –∑–∞–Ω–æ–≤–æ —Å —Ñ–ª–∞–≥–æ–º `-E`:
     * `celery -A celery_app worker -E --loglevel=INFO`

   * –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º `test_script.py`

   * –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É Flower (http://localhost:5555) ‚Üí –≤–∫–ª–∞–¥–∫–∞ Tasks / Dashboard

–î–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è –∑–∞–¥–∞—á–∏ (add, flaky_task), –∏—Ö —Å—Ç–∞—Ç—É—Å—ã, –∞—Ä–≥—É–º–µ–Ω—Ç—ã, –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∏ —Ç.–¥.
